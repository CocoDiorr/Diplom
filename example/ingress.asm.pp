loadbe ((((0x80000)-(0x40))-(0x80))+12), 0x10
cmpj ip4_proc, 0x800, 0x10
cmpj arp_proc, 0x806, 0x10
j finish
ip4_proc:
loadbe ((((0x80000)-(0x40))-(0x80))+26), 0x10
rol 0x10
orbe ((((0x80000)-(0x40))-(0x80))+28), 0x10
cmpj check_dst, 0xc0010101, 0x20
j control_port
arp_proc:
loadbe ((((0x80000)-(0x40))-(0x80))+38), 0x10
rol 0x10
orbe ((((0x80000)-(0x40))-(0x80))+40), 0x10
cmpj check_dst_arp, 0xb070c001, 0x20
j control_port
check_dst_arp:
loadbe ((((0x80000)-(0x40))-(0x80))+28), 0x10
rol 0x10
orbe ((((0x80000)-(0x40))-(0x80))+30), 0x10
cmpj forward_port_arpmatch, 0xb070c8dd, 0x20
j control_port
check_dst:
loadbe ((((0x80000)-(0x40))-(0x80))+30), 0x10
rol 0x10
orbe ((((0x80000)-(0x40))-(0x80))+32), 0x10
cmpj forward_port_ipmatch, 0xc0010102, 0x20
j control_port
forward_port_ipmatch:
load (((0x80000)-(0x40))+8), 0x20
ori 0x100
store (((0x80000)-(0x40))+8), 0x20
j finish
forward_port_arpmatch:
load (((0x80000)-(0x40))+8), 0x20
ori 0x80
store (((0x80000)-(0x40))+8), 0x20
j finish
control_port:
load ((((0x80000)-(0x40))+8)+0x7), 0x8
ori 0x80
store ((((0x80000)-(0x40))+8)+0x7), 0x8
j finish
finish:
