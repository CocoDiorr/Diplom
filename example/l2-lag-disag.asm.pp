loadbe ((((0x80000)-(0x40))-(0x80))+12), 0x10
cmpj tag_proc, 0x8100, 0x10
cmpj ip4_hash, 0x800, 0x10
cmpj ip6_hash, 0x86dd, 0x10
cmpj lacpdu_frame, 0x8809, 0x10
j l2_hash
lacpdu_frame:
load (((0x80000)-(0x40))+8), 0x10
ori 0x10
store (((0x80000)-(0x40))+8), 0x10
j finish
tag_proc:
loadbe ((((0x80000)-(0x40))-(0x80))+16), 0x10
cmpj ip4_hash_tagged, 0x800, 0x10
cmpj ip6_hash_tagged, 0x86dd, 0x10
j l2_hash_tagged
ip4_hash:
loadbe (((0x80000)-(0x40))-(0x80))+23, 0x8
cmpj ip4_tcpudp, 0x6, 0x8
cmpj ip4_tcpudp, 0x11, 0x8
loadbe (((0x80000)-(0x40))-(0x80))+32, 0x10
rol 0x20
orbe (((0x80000)-(0x40))-(0x80))+28, 0x20
rol 0x10
orbe (((0x80000)-(0x40))-(0x80))+26, 0x10
xor (((0x80000)-(0x40))-(0x80)), 0x20
xor (((((0x80000)-(0x40))-(0x80))+6)+2), 0x20
modi 3
j select_port
ip6_hash:
xorbe ((((0x80000)-(0x40))-(0x80))+44), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+48), 0x10
xorbe ((((0x80000)-(0x40))-(0x80))+40), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+36), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+32), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+28), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+24), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+22), 0x10
xor (((0x80000)-(0x40))-(0x80)), 0x20
xor (((((0x80000)-(0x40))-(0x80))+6)+2), 0x20
modi 3
j select_port
ip4_hash_tagged:
loadbe (((0x80000)-(0x40))-(0x80))+27, 0x8
cmpj ip4_tcpudp_tagged, 0x6, 0x8
cmpj ip4_tcpudp_tagged, 0x11, 0x8
loadbe (((0x80000)-(0x40))-(0x80))+36, 0x10
rol 0x20
orbe (((0x80000)-(0x40))-(0x80))+32, 0x20
rol 0x10
orbe (((0x80000)-(0x40))-(0x80))+30, 0x10
xor (((0x80000)-(0x40))-(0x80)), 0x20
xor (((((0x80000)-(0x40))-(0x80))+6)+2), 0x20
modi 3
j select_port
ip4_tcpudp:
xorbe ((((0x80000)-(0x40))-(0x80))+28), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+32), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+36), 0x10
xorbe ((((0x80000)-(0x40))-(0x80))+26), 0x10
modi 3
j select_port
ip4_tcpudp_tagged:
xorbe ((((0x80000)-(0x40))-(0x80))+32), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+36), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+40), 0x10
xorbe ((((0x80000)-(0x40))-(0x80))+30), 0x10
modi 3
j select_port
ip6_hash_tagged:
xorbe ((((0x80000)-(0x40))-(0x80))+48), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+52), 0x10
xorbe ((((0x80000)-(0x40))-(0x80))+44), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+40), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+36), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+32), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+28), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+26), 0x10
xor (((0x80000)-(0x40))-(0x80)), 0x20
xor (((((0x80000)-(0x40))-(0x80))+6)+2), 0x20
modi 3
j select_port
l2_hash:
loadbe ((((0x80000)-(0x40))-(0x80))), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+4), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+8), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+12), 0x10
modi 3
j select_port
l2_hash_tagged:
loadbe ((((0x80000)-(0x40))-(0x80))), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+4), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+8), 0x20
xorbe ((((0x80000)-(0x40))-(0x80))+16), 0x10
modi 3
j select_port
select_port:
cmpjg port_3, 0x1, 0x3
cmpjg port_2, 0x0, 0x3
load (((0x80000)-(0x40))+8), 0x10
ori 0x1
store (((0x80000)-(0x40))+8), 0x10
j finish
port_3:
load (((0x80000)-(0x40))+8), 0x10
ori 0x4
store (((0x80000)-(0x40))+8), 0x10
j finish
port_2:
load (((0x80000)-(0x40))+8), 0x10
ori 0x2
store (((0x80000)-(0x40))+8), 0x10
j finish
finish:
