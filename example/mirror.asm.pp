load ((((0x80000)-(0x40))+8)+0x7), 0x8
andi 0x40
cmpjg proc, 0, 0x8
ori 0x40
store ((((0x80000)-(0x40))+8)+0x7), 0x8
store ((((0x80000)-(0x40))-(0x80))-0x10), 0x8
j select_mirror_port
select_mirror_port:
load (((0x80000)-(0x40))+8), (0x40)
ori 0x5
store (((0x80000)-(0x40))+8), (0x40)
j check_outer_vlan
check_outer_vlan:
loadbe ((((0x80000)-(0x40))-(0x80))+12), 0x10
cmpj check_inner_vlan, 0x88a8, 0x10
cmpj single_tag, 0x8100, 0x10
j finish
check_inner_vlan:
loadbe (((((0x80000)-(0x40))-(0x80))+12)+4), 0x10
cmpj nested_tag, 0x8100, 0x10
j finish
single_tag:
j finish
nested_tag:
j finish
proc:
andi 0
store ((((0x80000)-(0x40))+8)+0x7), 0x8
load ((((0x80000)-(0x40))-(0x80))-0x10), 0x8
store (((0x80000)-(0x40))+8), 0x8
j finish
finish:
